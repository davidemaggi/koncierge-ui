@using KonciergeUi.Client.Shared
@using KonciergeUI.Models.Forwarding
@using KonciergeUi.Client.State

@inject UiState _ui;


<MudCard Elevation="0" Outlined="false" Style="@(getBackgroudColor())">
    <MudStack Row>
        <MudStack>
            <MudStack AlignItems="AlignItems.Center" Row>
                @if (_definition.ResourceType == Enums.ResourceType.Pod)
                {
                    <MudIcon Icon="@KonciergeIcons.Outlined.Pod" Size="Size.Small" Color="Color.Primary"/>
                }
                else
                {
                    <MudIcon Icon="@KonciergeIcons.Outlined.Service" Size="Size.Small" Color="Color.Secondary"/>

                }
                <MudText Style="font-family: monospace;" Typo="Typo.body1">@_definition.ResourceName</MudText>
            </MudStack>
            <MudText Style="font-family: monospace;" Typo="Typo.body2">@($"localhost:{_definition.LocalPort} -> {_definition.TargetPort}({_definition.Protocol.ToString()})")</MudText>
            @if (_definition.LinkedSecrets.Any()) 
            {
                <MudText Style="font-family: monospace;" Typo="Typo.body2">@($"{_definition.LinkedSecrets.Count} linked secret(s)")</MudText>
            }
        </MudStack>
        @if(_showRemove){
            <MudSpacer></MudSpacer>
        <MudButton StartIcon="@Icons.Material.Outlined.Delete" Color="Color.Error" OnClick="RemoveClicked">Remove</MudButton>
        }
    </MudStack>
</MudCard>
@code {
    [Parameter]
    public PortForwardDefinition _definition { get; set; }

    [Parameter] 
    public bool _showRemove { get; set; } = false;

    [Parameter] 
    public EventCallback<Guid> OnForwardRemoveAsync { get; set; }

    private async Task RemoveClicked()
    {
        await OnForwardRemoveAsync.InvokeAsync(_definition.Id);
    }
    private MudTheme Theme = new MudTheme();

    private string getBackgroudColor()

    {
        if (_ui.CurrentTheme=="Dark")
        {
            
            return $"background:rgba(0,255,0,0.3);";

        }

        return $"background:rgba(0,255,0,0.3);";
    }

}